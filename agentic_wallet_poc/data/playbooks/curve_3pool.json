{
  "protocol": "curve_3pool",
  "version": "1.0",
  "chain_id": 1,

  "contracts": {
    "pool_3crv": {
      "address": "0xbEbc44782C7dB0a1A60Cb6fe97d0b483032FF1C7",
      "abi_source": "etherscan_cache"
    }
  },

  "actions": {
    "curve_add_liquidity": {
      "description": "Add single-sided liquidity to Curve 3pool",
      "target_contract": "pool_3crv",
      "function_name": "add_liquidity",
      "abi_source": "etherscan_cache",
      "value_logic": { "type": "zero" },
      "required_payload_args": ["pool", "amounts", "min_mint_amount", "human_readable_amount"],

      "payload_args": {
        "pool": {
          "source": "resolve_contract_address",
          "contract_key": "pool_3crv"
        },
        "amounts": {
          "source": "build_fixed_array",
          "array_size": 3,
          "index_map": { "DAI": 0, "USDC": 1, "USDT": 2 },
          "llm_field": "amount_human",
          "asset_field": "asset",
          "decimals_from": "$asset",
          "fill_value": "0"
        },
        "min_mint_amount": {
          "source": "constant",
          "value": "0"
        },
        "human_readable_amount": {
          "source": "compute_human_readable",
          "template": "{amount_human} {asset}"
        }
      },

      "param_mapping": [
        { "name": "amounts",         "source": "arg", "arg_key": "amounts",         "coerce": "int_array" },
        { "name": "min_mint_amount", "source": "arg", "arg_key": "min_mint_amount", "coerce": "uint256" }
      ]
    },

    "curve_remove_liquidity": {
      "description": "Remove liquidity from Curve 3pool",
      "target_contract": "pool_3crv",
      "function_name": "remove_liquidity",
      "abi_source": "etherscan_cache",
      "value_logic": { "type": "zero" },
      "required_payload_args": ["pool", "amount", "min_amounts", "human_readable_amount"],

      "payload_args": {
        "pool": {
          "source": "resolve_contract_address",
          "contract_key": "pool_3crv"
        },
        "amount": {
          "source": "resolve_amount",
          "llm_field": "amount_human",
          "fallback_llm_fields": ["amount"],
          "decimals_from": 18
        },
        "min_amounts": {
          "source": "constant",
          "value": ["0", "0", "0"]
        },
        "human_readable_amount": {
          "source": "compute_human_readable",
          "template": "{amount_human} LP"
        }
      },

      "param_mapping": [
        { "name": "_amount",     "source": "arg", "arg_key": "amount",     "coerce": "uint256" },
        { "name": "min_amounts", "source": "arg", "arg_key": "min_amounts", "coerce": "int_array" }
      ]
    }
  }
}
